-- ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Player ‡πÅ‡∏•‡∏∞ Services
local player = game:GetService("Players").LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")
local data = playerGui:WaitForChild("Data")
local coinsObj = data:WaitForChild("Coins")
local Lighting = game:GetService("Lighting")

-- ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö error handling ‡πÅ‡∏•‡∏∞ optimization (‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á)
local dataConnected = true
local debugMode = false -- ‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î debug messages
local deathPointsCache = 0 -- cache DP
local deathPointsUpdateCounter = 0 -- ‡∏ô‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô loops
local timeUpdateCounter = 0 -- ‡∏ô‡∏±‡∏ö‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏ß‡∏•‡∏≤
local lastTickTime = tick() -- cache ‡πÄ‡∏ß‡∏•‡∏≤

-- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Death Points (‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô)
local function safeGetValue(object, defaultValue)
    if object and object.Value ~= nil then
        return object.Value
    end
    return defaultValue or 0
end

local function safeToString(value)
    if type(value) == "string" then
        return value
    elseif type(value) == "number" then
        return tostring(value)
    elseif type(value) == "userdata" and value.Name then
        return value.Name
    else
        return tostring(value)
    end
end

local function calculateDeathPoints()
    -- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô (‡∏•‡∏ö debug ‡∏≠‡∏≠‡∏Å)
    if not player or not player.Settings or not player.Settings.Slot then
        return 0
    end
    
    if not playerGui or not playerGui.Data then
        return 0
    end
    
    -- ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Slot ‡πÅ‡∏•‡∏∞ DeathStats (‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô)
    local currentSlotRaw = player.Settings.Slot.Value
    local currentSlot = safeToString(currentSlotRaw)
    
    local slotData = playerGui.Data:FindFirstChild(currentSlot)
    if not slotData then
        return 0
    end
    
    local deathStats = slotData:FindFirstChild("DeathStats")
    if not deathStats then
        return 0
    end
    
    -- ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡πá‡∏ß (‡∏•‡∏ö yield ‡∏≠‡∏≠‡∏Å)
    local totalPoints = 0
    
    -- 1. Growth Stages
    local adultValue = safeGetValue(deathStats:FindFirstChild("GrowCreatureAdult"), 0)
    local teenValue = safeGetValue(deathStats:FindFirstChild("GrowCreatureTeen"), 0)
    
    if adultValue == 1 then totalPoints = totalPoints + 7.5 end
    if teenValue == 1 then totalPoints = totalPoints + 7.5 end
    
    -- 2. Missions Completed
    local missionsCompleted = safeGetValue(deathStats:FindFirstChild("MissionsCompleted"), 0)
    totalPoints = totalPoints + (missionsCompleted * 4)
    
    -- 3. Disasters Survived
    local disastersSurvived = safeGetValue(deathStats:FindFirstChild("DisastersSurvived"), 0)
    totalPoints = totalPoints + (disastersSurvived * 6)
    
    -- 4. Time Played
    local timePlayed = safeGetValue(deathStats:FindFirstChild("TimePlayed"), 0)
    totalPoints = totalPoints + math.floor(timePlayed / 210)
    
    return totalPoints
end

-- üñ§ ‡∏™‡∏£‡πâ‡∏≤‡∏á GUI ‡∏•‡∏î CPU ‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô üñ§ --
local screenGui = Instance.new("ScreenGui")
screenGui.ResetOnSpawn = false
screenGui.IgnoreGuiInset = true
screenGui.Parent = playerGui

-- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏™‡∏µ‡∏î‡∏≥
local blackFrame = Instance.new("Frame")
blackFrame.Size = UDim2.new(1, 0, 1, 0)
blackFrame.Position = UDim2.new(0, 0, 0, 0)
blackFrame.BackgroundColor3 = Color3.new(0, 0, 0)
blackFrame.ZIndex = 10
blackFrame.Parent = screenGui

-- ‡∏™‡∏£‡πâ‡∏≤‡∏á Container Frame ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
local mainContainer = Instance.new("Frame")
mainContainer.Size = UDim2.new(0.9, 0, 0.7, 0)
mainContainer.Position = UDim2.new(0.05, 0, 0.15, 0)
mainContainer.BackgroundTransparency = 1
mainContainer.ZIndex = 11
mainContainer.Parent = screenGui

-- üéÆ ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô (‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡∏™‡∏∏‡∏î)
local playerNameLabel = Instance.new("TextLabel")
playerNameLabel.Size = UDim2.new(1, 0, 0.15, 0)
playerNameLabel.Position = UDim2.new(0, 0, 0, 0)
playerNameLabel.BackgroundTransparency = 1
playerNameLabel.TextColor3 = Color3.new(0, 1, 1) -- ‡∏™‡∏µ‡∏ü‡πâ‡∏≤‡∏≠‡πà‡∏≠‡∏ô
playerNameLabel.Font = Enum.Font.SourceSansBold
playerNameLabel.TextScaled = true
playerNameLabel.Text = "üéÆ " .. player.Name
playerNameLabel.ZIndex = 12
playerNameLabel.Parent = mainContainer

-- ‚òÑÔ∏è ‡∏¢‡∏≠‡∏î GAE (‡πÄ‡∏´‡πá‡∏î)
local shoomsLabel = Instance.new("TextLabel")
shoomsLabel.Size = UDim2.new(1, 0, 0.2, 0)
shoomsLabel.Position = UDim2.new(0, 0, 0.2, 0)
shoomsLabel.BackgroundTransparency = 1
shoomsLabel.TextColor3 = Color3.new(1, 1, 0) -- ‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á
shoomsLabel.Font = Enum.Font.SourceSansBold
shoomsLabel.TextScaled = true
shoomsLabel.Text = "‚òÑÔ∏è GAE: 0"
shoomsLabel.ZIndex = 12
shoomsLabel.Parent = mainContainer

-- DP
local deathPointsLabel = Instance.new("TextLabel")
deathPointsLabel.Size = UDim2.new(1, 0, 0.2, 0)
deathPointsLabel.Position = UDim2.new(0, 0, 0.45, 0)
deathPointsLabel.BackgroundTransparency = 1
deathPointsLabel.TextColor3 = Color3.new(1, 0.5, 0) -- ‡∏™‡∏µ‡∏™‡πâ‡∏°
deathPointsLabel.Font = Enum.Font.SourceSansBold
deathPointsLabel.TextScaled = true
deathPointsLabel.Text = "DP: 0"
deathPointsLabel.ZIndex = 12
deathPointsLabel.Parent = mainContainer

-- ‚è≥ ‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå
local timeLabel = Instance.new("TextLabel")
timeLabel.Size = UDim2.new(1, 0, 0.1, 0)
timeLabel.Position = UDim2.new(0, 0, 0.7, 0)
timeLabel.BackgroundTransparency = 1
timeLabel.TextColor3 = Color3.new(0.5, 1, 0.5) -- ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏≠‡πà‡∏≠‡∏ô
timeLabel.Font = Enum.Font.SourceSansBold
timeLabel.TextScaled = true
timeLabel.Text = "‚è≥ Online: 00:00:00"
timeLabel.ZIndex = 12
timeLabel.Parent = mainContainer

-- üïê ‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (Game Time)
local currentTimeLabel = Instance.new("TextLabel")
currentTimeLabel.Size = UDim2.new(1, 0, 0.1, 0)
currentTimeLabel.Position = UDim2.new(0, 0, 0.82, 0)
currentTimeLabel.BackgroundTransparency = 1
currentTimeLabel.TextColor3 = Color3.new(0.8, 0.8, 1) -- ‡∏™‡∏µ‡∏°‡πà‡∏ß‡∏á‡∏≠‡πà‡∏≠‡∏ô
currentTimeLabel.Font = Enum.Font.SourceSansBold
currentTimeLabel.TextScaled = true
currentTimeLabel.Text = "üïê Game Time: 00:00:00"
currentTimeLabel.ZIndex = 12
currentTimeLabel.Parent = mainContainer

-- ‡πÄ‡∏™‡πâ‡∏ô‡∏ï‡∏Å‡πÅ‡∏ï‡πà‡∏á (‡πÄ‡∏™‡πâ‡∏ô‡∏Ñ‡∏±‡πà‡∏ô)
local decorLine1 = Instance.new("Frame")
decorLine1.Size = UDim2.new(0.8, 0, 0.005, 0)
decorLine1.Position = UDim2.new(0.1, 0, 0.17, 0)
decorLine1.BackgroundColor3 = Color3.new(1, 1, 1)
decorLine1.BorderSizePixel = 0
decorLine1.ZIndex = 12
decorLine1.Parent = mainContainer

local decorLine2 = Instance.new("Frame")
decorLine2.Size = UDim2.new(0.8, 0, 0.005, 0)
decorLine2.Position = UDim2.new(0.1, 0, 0.68, 0)
decorLine2.BackgroundColor3 = Color3.new(1, 1, 1)
decorLine2.BorderSizePixel = 0
decorLine2.ZIndex = 12
decorLine2.Parent = mainContainer

-- ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
local startTime = tick()
local initialShooms = coinsObj and coinsObj.Value or 0
local lastShooms = initialShooms
local lastUpdateTime = tick()
local previousShooms = initialShooms

-- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏°‡∏≤‡∏Å)
local function updateAllData()
    local currentTick = tick()
    
    -- ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏∏‡∏Å 2 ‡∏£‡∏≠‡∏ö‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô (‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£)
    timeUpdateCounter = timeUpdateCounter + 1
    if timeUpdateCounter >= 2 then
        timeUpdateCounter = 0
        
        -- ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå
        local elapsedTime = currentTick - startTime
        local hours = math.floor(elapsedTime / 3600)
        local minutes = math.floor((elapsedTime % 3600) / 60)
        local seconds = math.floor(elapsedTime % 60)
        timeLabel.Text = "‚è≥ Online: " .. string.format("%02d:%02d:%02d", hours, minutes, seconds)
        
        -- ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏ß‡∏•‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏Ç‡∏≠‡∏á Roblox)
        local currentGameTime = os.date("*t")
        currentTimeLabel.Text = "üïê Game Time: " .. string.format("%02d:%02d:%02d", currentGameTime.hour, currentGameTime.min, currentGameTime.sec)
    end

    -- ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏¢‡∏≠‡∏î GAE (Shooms) - ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏ö‡∏≤‡∏Å‡∏ß‡πà‡∏≤ (‡∏ó‡∏∏‡∏Å‡∏£‡∏≠‡∏ö)
    local currentShooms = coinsObj and coinsObj.Value or 0
    local shoomsDifference = currentShooms - initialShooms
    
    -- ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Shooms ‡∏ï‡πà‡∏≠ loop (‡πÅ‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î)
    local timeSinceLastUpdate = currentTick - lastUpdateTime
    local shoomsGained = currentShooms - previousShooms
    local shoomsPerLoop = 0
    
    if timeSinceLastUpdate > 0 and shoomsGained > 0 then
        shoomsPerLoop = math.floor((shoomsGained / timeSinceLastUpdate) * 30 * 10) / 10 -- ‡∏õ‡∏±‡∏î‡∏ó‡∏®‡∏ô‡∏¥‡∏¢‡∏° 1 ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á
    end
    
    -- ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ñ‡πà‡∏≤‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö loop ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
    lastUpdateTime = currentTick
    previousShooms = currentShooms

    -- ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• GAE
    if shoomsDifference > 0 then
        shoomsLabel.Text = "‚òÑÔ∏è GAE: " .. currentShooms .. " (+" .. shoomsDifference .. ") | " .. shoomsPerLoop .. "/loop"
    else
        shoomsLabel.Text = "‚òÑÔ∏è GAE: " .. currentShooms .. " | 0.0/loop"
    end
    
    -- ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï DP (‡∏ó‡∏∏‡∏Å 5 loops ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏°‡∏≤‡∏Å)
    deathPointsUpdateCounter = deathPointsUpdateCounter + 1
    
    -- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏Å‡∏°‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á
    local playerInGame = game.Workspace.Characters:FindFirstChild(player.Name)
    
    if not playerInGame then
        deathPointsLabel.Text = "DP: ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏Å‡∏°"
        deathPointsCache = 0
    else
        -- ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì DP ‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏∏‡∏Å 5 loops ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô (‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°)
        if deathPointsUpdateCounter >= 5 then
            deathPointsUpdateCounter = 0
            local success, deathPoints = pcall(calculateDeathPoints)
            if success then
                deathPointsCache = deathPoints
                deathPointsLabel.Text = "DP: " .. deathPoints
            else
                deathPointsLabel.Text = "DP: Error"
            end
        else
            -- ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤ cache (‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£)
            deathPointsLabel.Text = "DP: " .. deathPointsCache
        end
    end
end

-- ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
local success, error = pcall(updateAllData)

-- ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏∏‡∏Å 300 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ (‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å 300 ‡πÄ‡∏õ‡πá‡∏ô 300 ‡πÅ‡∏ï‡πà‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì)
while true do
    task.wait(1) -- ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å 300 ‡πÄ‡∏õ‡πá‡∏ô 300 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‡πÅ‡∏ï‡πà‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô
    
    local success, error = pcall(updateAllData)
    if not success then
        -- ‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà‡∏Å‡πà‡∏≠‡∏ô‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà (‡πÉ‡∏ô‡∏Å‡∏£‡∏ì‡∏µ error)
        task.wait(5)
    end
end
